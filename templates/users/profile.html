{% extends "base.html" %}
{% load static %}

{% block title %}Кабинет охраны{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="profile-info">
        {% if not edit_mode %}
        <h1>Кабинет охраны</h1>

        <div class="profile-divider"></div>

        <div class="profile-view">
            <div class="profile-field">
                <p>
                    <strong>Никнейм:</strong>
                    {{ user.username }}
                </p>
            </div>
            <div class="profile-field">
                <p>
                    <strong>Имя:</strong>
                    {{ user.first_name|default:"Не указано" }}
                </p>
            </div>
            <div class="profile-field">
                <p>
                    <strong>Фамилия:</strong>
                    {{ user.last_name|default:"Не указано" }}
                </p>
            </div>
            <div class="profile-field">
                <p>
                    <strong>Email:</strong>
                    {{ user.email }}
                </p>
            </div>
            <div class="profile-field">
                <p>
                    <strong>Дата регистрации:</strong>
                    {{ user.date_joined|date:"d.m.Y H:i" }}
                </p>
            </div>
            <div class="profile-field">
                <p>
                    <strong>Последний вход:</strong>
                    {{ user.last_login|date:"d.m.Y H:i"|default:"Ещё не входил" }}
                </p>
            </div>

            <div class="profile-actions">
                <a href="?edit=true" class="btn btn-edit">
                    Редактировать данные
                </a>
                <form action="{% url 'logout' %}" method="post"
                      class="logout-form">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-logout">
                        Выйти из аккаунта
                    </button>
                </form>
            </div>
        </div>

        <div class="profile-divider"></div>

        {% else %}
        <h1>Редактирование данных</h1>

        <div class="profile-divider"></div>

        <form method="post" class="profile-edit-form">
            {% csrf_token %}
            <div class="form-group">
                <label for="id_username">Никнейм:</label>
                {{ form.username }}
                {% if form.username.errors %}
                <div class="error">{{ form.username.errors }}</div>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="id_first_name">Имя:</label>
                {{ form.first_name }}
                {% if form.first_name.errors %}
                <div class="error">{{ form.first_name.errors }}</div>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="id_last_name">Фамилия:</label>
                {{ form.last_name }}
                {% if form.last_name.errors %}
                <div class="error">{{ form.last_name.errors }}</div>
                {% endif %}
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-save">
                    Сохранить изменения
                </button>
                <a href="." class="btn btn-cancel">Отменить изменения</a>
            </div>
        </form>
        {% endif %}
    </div>
</div>
{% endblock %}
